!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs/observable/fromEvent")):"function"==typeof define&&define.amd?define(["exports","@angular/core","rxjs/observable/fromEvent"],t):t(e["meepo-idesign-share"]={},e.ng.core,e.Rx.Observable)}(this,function(e,t,n){"use strict";var o=new t.InjectionToken("DESIGN_LIBRARYS"),r=function(){function e(){}return e.prototype.get=function(e){},e.prototype.save=function(e,t){},e}();r.decorators=[{type:t.Injectable}],r.ctorParameters=function(){return[]};var i=function(){function e(e){var t;this.components=[],this.components=(t=e,Array.prototype.concat.apply([],t))}return e.prototype.get=function(e){var t;return this.components.map(function(n){n[e]&&(t=n[e])}),t},e}();i.decorators=[{type:t.Injectable}],i.ctorParameters=function(){return[{type:undefined,decorators:[{type:t.Inject,args:[o]}]}]};var s=function(){function e(e,t,n,o){this._viewContainerRef=e,this._template=t,this.differs=n,this.librarys=o,this.instances=[],this.viewContainerRef=e}return e.prototype.ngDoCheck=function(){var e=this;if(this._differ){var t=this._differ.diff(this.ngComponent);t&&t.forEachOperation(function(t,n,o){if(null==t.previousIndex)e.createComponent(t,o);else if(null==o)e._viewContainerRef.remove(n);else{var r=e._viewContainerRef.get(n);e._viewContainerRef.move(r,o)}})}},e.prototype.createComponent=function(e,n){var o=this;try{var r=e.item,i=void 0,s=this.librarys.get(r.name);i=this.ngComponentPreview?s.view:s.setting;var p=this.viewContainerRef.parentInjector,c=(this.moduleRef?this.moduleRef.componentFactoryResolver:p.get(t.ComponentFactoryResolver)).resolveComponentFactory(i),u=this.viewContainerRef.createComponent(c,n,p);u.instance.props=r.props,u.instance.onClick.subscribe(function(e){o.ngComponentClick&&o.ngComponentClick(r)}),u.instance.setClass(this.ngComponentClass),u.instance.setStyle(this.ngComponentStyle),this.setDrage(u.instance),this.setDrop(u.instance),r.uuid=u.instance.guid;var f=new a(u.instance.guid,r);this.instances.push(f)}catch(v){}},e.prototype.ngOnChanges=function(e){if(this.viewContainerRef.clear(),"ngComponent"in e){var t=e.ngComponent.currentValue;if(t&&!this._differ)try{this._differ=this.differs.find(t).create()}catch(n){}}},e.prototype.setDrage=function(e){e.setAttribute({draggable:!0});var t=e.ele.nativeElement;n.fromEvent(t,"dragstart").subscribe(function(t){e.guid,t.dataTransfer.setData("name",e.guid)}),n.fromEvent(t,"dragleave").subscribe(function(e){}),n.fromEvent(t,"dragend").subscribe(function(e){})},e.prototype.setDrop=function(e){var t=this,o=e.ele.nativeElement;n.fromEvent(o,"drop").subscribe(function(n){n.preventDefault(),n.stopPropagation();var o=n.dataTransfer.getData("name");if(e.guid!==o){var r=t.getInstanceProps(o);r&&e.props.children.push(r)}}),n.fromEvent(o,"dragover").subscribe(function(e){o.style.bor,e.preventDefault(),e.stopPropagation()})},e.prototype.getInstanceProps=function(e){var t;return this.instances.map(function(n){n.guid===e&&(t=n.props)}),t},e}();s.decorators=[{type:t.Directive,args:[{selector:"[ngComponent]"}]}],s.ctorParameters=function(){return[{type:t.ViewContainerRef},{type:t.TemplateRef},{type:t.IterableDiffers},{type:i}]},s.propDecorators={ngComponent:[{type:t.Input}],ngComponentPreview:[{type:t.Input}],ngComponentState:[{type:t.Input}],ngComponentClass:[{type:t.Input}],ngComponentStyle:[{type:t.Input}],ngComponentDrag:[{type:t.Input}],ngComponentDrop:[{type:t.Input}],ngComponentClick:[{type:t.Input}]};var a=function(){return function(e,t){this.guid=e,this.props=t}}(),p=function(){return function(){}}();p.decorators=[{type:t.NgModule,args:[{imports:[],exports:[s],declarations:[s],providers:[]}]}],p.ctorParameters=function(){return[]},e.IDesignComponentModule=p,e.NgComponentDirective=s,e.InstanceComponent=a,e.DesignApiService=r,e.DesignLibraryService=i,e.DESIGN_LIBRARYS=o,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=meepo-idesign-share.umd.min.js.map
